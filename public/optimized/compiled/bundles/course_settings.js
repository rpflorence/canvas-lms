define("vendor/jquery.cookie",["jquery"],function(a){jQuery.cookie=function(a,b,c){if(typeof b=="undefined"){var i=null;if(document.cookie&&document.cookie!=""){var j=document.cookie.split(";");for(var k=0;k<j.length;k++){var l=jQuery.trim(j[k]);if(l.substring(0,a.length+1)==a+"="){i=decodeURIComponent(l.substring(a.length+1));break}}}return i}c=c||{},b===null&&(b="",c.expires=-1);var d="";if(c.expires&&(typeof c.expires=="number"||c.expires.toUTCString)){var e;typeof c.expires=="number"?(e=new Date,e.setTime(e.getTime()+c.expires*24*60*60*1e3)):e=c.expires,d="; expires="+e.toUTCString()}var f=c.path?"; path="+c.path:"",g=c.domain?"; domain="+c.domain:"",h=c.secure?"; secure":"";document.cookie=[a,"=",encodeURIComponent(b),d,f,g,h].join("")}}),require(["INST","i18n","jquery","jquery.ajaxJSON","jquery.instructure_forms","jquery.instructure_misc_helpers","jquery.instructure_misc_plugins","jquery.loadingImg","jquery.rails_flash_notifications","jquery.scrollToVisible","jquery.templateData","vendor/jquery.scrollTo"],function(a,b,c){b=b.scoped("user_lists");var d=c("#user_lists_processed_person_template").removeAttr("id").detach(),e=c("#user_list_no_valid_users"),f=c("#user_list_with_errors"),g=c("#user_lists_processed_people"),h=c("#user_list_duplicates_found"),i=c("#enroll_users_form"),j=c("#enrollment_blank").removeAttr("id").hide(),k=c("#user_lists_path").attr("href"),l=a.UserLists={init:function(){l.showTextarea(),i.find(".cancel_button").click(function(){c(".add_users_link").show(),i.hide()}).end().find(".go_back_button").click(l.showTextarea).end().find(".verify_syntax_button").click(function(a){a.preventDefault(),l.showProcessing(),c.ajaxJSON(k,"POST",i.getFormData(),l.showResults)}).end().submit(function(a){a.preventDefault(),a.stopPropagation(),i.find(".add_users_button").text(b.t("adding_users","Adding Users...")).attr("disabled",!0),c.ajaxJSON(i.attr("action"),"POST",i.getFormData(),function(a){i.find(".user_list").val(""),l.showTextarea();if(!a||!a.length)return!1;c.each(a,function(){l.addUserToList(this.enrollment)}),c.flashMessage(b.t("users_added",{one:"1 user added",other:"%{count} users added"},{count:a.length}))},function(a){c.flashError(b.t("users_adding_failed","Failed to enroll users"))})}),i.find("#enrollment_type").change(function(){c("#limit_privileges_to_course_section_holder").showIf(c(this).val()=="TeacherEnrollment"||c(this).val()=="TaEnrollment")}).change(),c(".unenroll_user_link").click(function(a){a.preventDefault(),a.stopPropagation(),c(this).hasClass("cant_unenroll")?alert(b.t("cant_unenroll","This user was automatically enrolled using the campus enrollment system, so they can't be manually removed.  Please contact your system administrator if you have questions.")):c(this).parents(".user").confirmDelete({message:b.t("delete_confirm","Are you sure you want to remove this user?"),url:c(this).attr("href"),success:function(){c(this).fadeOut(function(){l.updateCounts()})}})})},showTextarea:function(){i.find(".add_users_button, .go_back_button, #user_list_parsed").hide(),i.find(".verify_syntax_button, .cancel_button, #user_list_textarea_container").show().removeAttr("disabled"),i.find(".user_list").removeAttr("disabled").loadingImage("remove").focus().select(),i.find(".verify_syntax_button").attr("disabled",!1).text(b.t("buttons.continue","Continue..."))},showProcessing:function(){i.find(".verify_syntax_button").attr("disabled",!0).text(b.t("messages.processing","Processing...")),i.find(".user_list").attr("disabled",!0).loadingImage()},showResults:function(a){i.find(".add_users_button, .go_back_button, #user_list_parsed").show(),i.find(".add_users_button").attr("disabled",!1).text(b.t("add_n_users",{one:"OK Looks Good, Add This 1 User",other:"OK Looks Good, Add These %{count} Users"},{count:a.users.length})),i.find(".verify_syntax_button, .cancel_button, #user_list_textarea_container").hide(),i.find(".user_list").removeAttr("disabled").loadingImage("remove"),g.html("").show(),!a||!a.users||!a.users.length?(e.appendTo(g),i.find(".add_users_button").hide()):(a.errored_users&&a.errored_users.length&&f.appendTo(g).find(".message_content").html(b.t("user_parsing_errors",{one:"There was 1 error parsing that list of users.",other:"There were %{count} errors parsing that list of users."},{count:a.errored_users.length})+" "+b.t("invalid_users_notice","There may be some that were invalid, and you might need to go back and fix any errors.")+" "+b.t("users_to_add",{one:"If you proceed as is, 1 user will be added.",other:"If you proceed as is, %{count} users will be added."},{count:a.users.length})),a.duplicates&&a.duplicates.length&&h.appendTo(g).find(".message_content").html(b.t("duplicate_users",{one:"1 duplicate user found, duplicates have been removed.",other:"%{count} duplicate user found, duplicates have been removed."},{count:a.duplicates.length})),c.each(a.users,function(){d.clone(!0).fillTemplateData({data:this}).appendTo(g).show()}))},updateCounts:function(){c.each(["student","teacher","ta","teacher_and_ta","student_and_observer","observer"],function(){c("."+this+"_count").text(c("."+this+"_enrollments .user:visible").length)})},addUserToList:function(a){var d=c.underscore(a.type),e=c(".user_list."+d+"s");e.length||(d=="student_enrollment"||d=="observer_enrollment"?e=c(".user_list.student_and_observer_enrollments"):e=c(".user_list.teacher_and_ta_enrollments")),e.find(".none").remove(),a.invitation_sent_at=b.t("just_now","Just Now");var f=null;e.find(".user").each(function(){var b=c(this).getTemplateData({textValues:["name"]}).name;if(b&&a.name&&b.toLowerCase()>a.name.toLowerCase())return f=c(this),!1});if(!c("#enrollment_"+a.id).length){var g=j.clone(!0).fillTemplateData({textValues:["name","membership_type","email"],id:"enrollment_"+a.id,hrefValues:["id","user_id","pseudonym_id","communication_channel_id"],data:a}).addClass(d).removeClass("nil_class user_").addClass("user_"+a.user_id).toggleClass("pending",a.workflow_state!="active")[f?"insertBefore":"appendTo"](f||e).show().animate({backgroundColor:"#FFEE88"},1e3).animate({display:"block"},2e3).animate({backgroundColor:"#FFFFFF"},2e3,function(){c(this).css("backgroundColor","")});g.parents(".user_list").scrollToVisible(g)}l.updateCounts()}};c(a.UserLists.init)}),define("user_lists",function(){}),require(["i18n","jquery","jquery.ajaxJSON","jquery.instructure_date_and_time","jquery.instructure_forms","jquery.instructure_jquery_patches","jquery.instructure_misc_helpers","jquery.instructure_misc_plugins","jquery.keycodes","jquery.loadingImg","jquery.rails_flash_notifications","jquery.templateData","link_enrollment","vendor/jquery.ba-tinypubsub","vendor/jquery.scrollTo","jqueryui/autocomplete","jqueryui/sortable","jqueryui/tabs"],function(a,b){a=a.scoped("course_settings");var c={status:null,checkup:function(){b.ajaxJSON(b("#publish_to_sis_form").attr("action"),"GET",{},function(a){if(!a.hasOwnProperty("sis_publish_overall_status"))return;c.status=a.sis_publish_overall_status,c.update(a.hasOwnProperty("sis_publish_statuses")?a.sis_publish_statuses:{})})},update:function(d,e){var f=b("#publish_grades_link"),g=b("#publish_grades_error");c.status=="published"?(g.hide(),f.html(a.t("links.republish","Republish grades to SIS")),f.removeClass("disabled")):c.status=="publishing"||c.status=="pending"?(g.hide(),f.html(a.t("links.publishing","Publishing grades to SIS...")),e||setTimeout(c.checkup,5e3),f.addClass("disabled")):c.status=="unpublished"?(g.hide(),f.html(a.t("links.publish","Publish grades to SIS")),f.removeClass("disabled")):(g.show(),f.html(a.t("links.republish","Republish grades to SIS")),f.removeClass("disabled")),$messages=b("#publish_grades_messages"),$messages.empty(),b.each(d,function(a,c){var d=b("<span/>");d.text(a);var e=b("<li/>");e.append(d),e.append(" - <b>"+c.length+"</b>"),$messages.append(e)})},publish:function(){if(c.status=="publishing"||c.status=="pending"||c.status==null)return;if(c.status=="published"){if(!confirm(a.t("confirm.re_publish_grades","Are you sure you want to republish these grades to the student information system?")))return}else if(!confirm(a.t("confirm.publish_grades","Are you sure you want to publish these grades to the student information system? You should only do this if all your grades have been finalized.")))return;var d=b("#publish_to_sis_form");c.status="publishing",c.update({},!0);var e={published:1,publishing:1,pending:1},f=function(d,e,f,g){c.status="unknown",b.flashError(a.t("errors.publish_grades","Something went wrong when trying to publish grades to the student information system. Please try again later.")),c.update({})};b.ajaxJSON(d.attr("action"),"POST",d.getFormData(),function(b){if(!b.hasOwnProperty("sis_publish_overall_status")||!e.hasOwnProperty(b.sis_publish_overall_status)){f(null,null,a.t("errors.invalid_sis_status","Invalid SIS publish status"),null);return}c.status=b.sis_publish_overall_status,c.update(b.hasOwnProperty("sis_publish_statuses")?b.sis_publish_statuses:{})},f)}};b(document).ready(function(){var d=b("#add_section_form"),e=b("#edit_section_form"),f=b("#course_form"),g=b(".hashtag_form"),h=b("#course_hashtag"),i=b("#enroll_users_form"),j=b("#enrollment_dialog");b("#course_details_tabs").tabs({cookie:{}}).show(),d.formSubmit({required:["course_section[name]"],beforeSubmit:function(b){d.find("button").attr("disabled",!0).text(a.t("buttons.adding_section","Adding Section..."))},success:function(c){var e=c.course_section,f=b(".section_blank:first").clone(!0).attr("class","section"),g=b("<option/>");d.find("button").attr("disabled",!1).text(a.t("buttons.add_section","Add Section")),f.fillTemplateData({data:e,hrefValues:["id"]}),b("#course_section_id_holder").show(),g.val(e.id).text(e.name).addClass("option_for_section_"+e.id),b("#sections .section_blank").before(f),f.slideDown(),b("#course_section_name").val()},error:function(b){d.formErrors(b).find("button").attr("disabled",!1).text(a.t("errors.section","Add Section Failed, Please Try Again"))}}),b(".cant_delete_section_link").click(function(a){return alert(b(this).attr("title")),!1}),e.formSubmit({beforeSubmit:function(a){e.hide();var b=e.parents(".section");return b.find(".name").text(a["course_section[name]"]).show(),b.loadingImage({image_size:"small"}),b},success:function(a,c){var d=a.course_section;c.loadingImage("remove"),b(".option_for_section_"+d.id).text(d.name)},error:function(a,b){b.loadingImage("remove").find(".edit_section_link").click(),e.formErrors(a)}}).find(":text").bind("blur",function(){e.submit()}).keycodes("return esc",function(a){a.keyString=="return"?e.submit():(b(this).parents(".section").find(".name").show(),b("body").append(e.hide()))}),b(".edit_section_link").click(function(){var a=b(this),c=a.parents(".section"),d=c.getTemplateData({textValues:["name"]});return e.fillFormData(d,{object_name:"course_section"}),c.find(".name").hide().after(e.show()),e.attr("action",a.attr("href")),e.find(":text:first").focus().select(),!1}),b(".delete_section_link").click(function(){return b(this).parents(".section").confirmDelete({url:b(this).attr("href"),message:a.t("confirm.delete_section","Are you sure you want to delete this section?"),success:function(a){b(this).slideUp(function(){b(this).remove()})}}),!1}),b("#nav_form").submit(function(){function a(a){var c=b(a).attr("id");if(c){var d=c.replace(/^nav_edit_tab_id_/,"");if(d.length>0)return d.match(/context/)||(d=parseInt(d,10)),d}return null}tab_id_regex=/(\d+)$/;var c=[];return b("#nav_enabled_list li").each(function(){var b=a(this);b!==null&&c.push({id:b})}),b("#nav_disabled_list li").each(function(){var b=a(this);b!==null&&c.push({id:b,hidden:!0})}),b("#tabs_json").val(JSON.stringify(c)),!0}),b(".edit_nav_link").click(function(a){a.preventDefault(),b("#nav_form").dialog("close").dialog({modal:!0,resizable:!1,width:400}).dialog("open")}),b("#nav_enabled_list, #nav_disabled_list").sortable({items:"li.enabled",connectWith:".connectedSortable",axis:"y"}).disableSelection(),b(".hashtag_dialog_link").click(function(c){c.preventDefault(),b("#hashtag_dialog").dialog("close").dialog({autoOpen:!1,title:a.t("titles.hashtag_help","What's a Hashtag?"),width:500}).dialog("open")}),b(".close_dialog_button").click(function(){b("#hashtag_dialog").dialog("close")}),b("#course_hashtag").bind("blur change keyup",function(){var a=b(this).val()||"";a=a.replace(/(\s)+/g,"_").replace(/#/,""),b("#hashtag_options").showIf(a&&a!==""),b(this).val(a)}),b(document).fragmentChange(function(a,c){function d(a){b("#tab-users-link").click(),b(".add_users_link:visible").click(),b("#enroll_users_form select[name='enrollment_type']").val(a)}c=="#add_students"?d("StudentEnrollment"):c=="#add_tas"?d("TaEnrollment"):c=="#add_teacher"&&d("TeacherEnrollment")}),b(".edit_course_link").click(function(a){a.preventDefault(),b("#course_form").addClass("editing").find(":text:first").focus().select(),b("#course_account_id_lookup").autocomplete({source:b("#course_account_id_url").attr("href"),select:function(a,c){b("#course_account_id").val(c.item.id)}}),g.showIf(h.text().length>0),h.triggerHandler("blur")}),b(".move_course_link").click(function(c){c.preventDefault(),b("#move_course_dialog").dialog("close").dialog({autoOpen:!1,title:a.t("titles.move_course","Move Course"),width:500}).dialog("open")}),b("#move_course_dialog").delegate(".cancel_button","click",function(){b("#move_course_dialog").dialog("close")}),f.find(".grading_standard_checkbox").change(function(){f.find(".grading_standard_link").showIf(b(this).attr("checked"))}).change(),f.formSubmit({processData:function(a){return a["course[hashtag]"]=(a["course[hashtag]"]||"").replace(/\s/g,"_").replace(/#/g,""),a["course[start_at]"]&&(a["course[start_at]"]+=" 12:00am"),a["course[conclude_at]"]&&(a["course[conclude_at]"]+=" 11:55pm"),a},beforeSubmit:function(a){b(this).loadingImage().removeClass("editing"),b(this).find(".readable_license,.account_name,.term_name,.grading_scheme_set").text("..."),b(this).find(".storage_quota_mb").text(a["course[storage_quota_mb]"]),b(".course_form_more_options").hide()},success:function(c){var d=c.course;d.start_at=b.parseFromISO(d.start_at).datetime_formatted,d.conclude_at=b.parseFromISO(d.conclude_at).datetime_formatted,d.is_public=d.is_public?a.t("public_course","Public"):a.t("private_course","Private"),d.indexed=d.indexed?a.t("indexed_course","Included in public course index"):"",d.grading_scheme_set=d.grading_standard_title||(d.grading_standard_id?a.t("grading_standard_set","Currently Set"):a.t("grading_standard_unset","Not Set")),d.restrict_dates=d.restrict_enrollments_to_course_dates?a.t("course_dates_enforced","Users can only participate in the course between these dates"):a.t("course_dates_unenforced","These dates will not affect course availability"),d.locale=b("#course_locale option[value='"+(d.locale||"")+"']").text();if(d.locale!=f.find(".locale").text()){location.reload();return}b(this).loadingImage("remove"),b("#course_form .public_options").showIf(d.is_public),b("#course_form .self_enrollment_message").css("display",d.self_enrollment?"":"none"),b("#course_form").fillTemplateData({data:d}),b(".hashtag_form").showIf(b("#course_hashtag").text().length>0)},error:function(a){b(this).loadingImage("remove"),b(".edit_course_link").click(),b(this).formErrors(a)}}).find(".cancel_button").click(function(){f.removeClass("editing"),g.showIf(h.text().length>0),b(".course_form_more_options").hide()}).end().find(":text:not(.date_entry)").keycodes("esc",function(){f.find(".cancel_button:first").click()}),i.hide(),b(".add_users_link").click(function(a){b(this).hide(),a.preventDefault(),i.show(),b("html,body").scrollTo(i),i.find("textarea").focus().select()}),b(".associate_user_link").click(function(a){a.preventDefault();var c=b(this).parents(".user"),d=c.getTemplateData({textValues:["name","associated_user_id","id"]});link_enrollment.choose(d.name,d.id,d.associated_user_id,function(a){if(a){var c=a.associated_user_name;b("#enrollment_"+a.id).find(".associated_user.associated").showIf(a.associated_user_id).end().find(".associated_user.unassociated").showIf(!a.associated_user_id).end().fillTemplateData({data:a})}})}),b(".course_info").attr("title",a.t("titles.click_to_edit","Click to Edit")).click(function(a){if(a.target.nodeName=="INPUT")return;b(".edit_course_link:first").click();var c=b(this).parents("td").find(".course_form");c.length&&c.focus().select()}),b(".course_form_more_options_link").click(function(a){a.preventDefault(),b(".course_form_more_options").slideToggle()}),b(".user_list").delegate(".user","mouseover",function(c){var d=b(this),e=d.attr("title"),f=a.t("details.re_send_invitation","This user has not yet accepted their invitation.  Click to re-send invitation.");e!=f&&d.data("real_title",e),d.hasClass("pending")?d.attr("title",f).css("cursor","pointer"):d.attr("title",b(this).data("real_title")||a.t("defaults.user_name","User")).css("cursor","")}),j.find(".cancel_button").click(function(){j.dialog("close")}),b(".user_list").delegate(".user_information_link","click",function(c){var d=b(this),e=d.closest(".user"),f=e.hasClass("pending"),g=e.getTemplateData({textValues:["name","invitation_sent_at"]}),h=e.parents(".teacher_enrollments,.ta_enrollments").length>0;return g.re_send_invitation_link=a.t("links.re_send_invitation","Re-Send Invitation"),j.data("user",e).find(".re_send_invitation_link").attr("href",e.find(".re_send_confirmation_url").attr("href")).end().find(".student_enrollment_re_send").showIf(f&&!h).end().find(".admin_enrollment_re_send").showIf(f&&h).end().find(".accepted_enrollment_re_send").showIf(!f).end().find(".invitation_sent_at").showIf(f).end().fillTemplateData({data:g}).dialog("close").dialog({autoOpen:!1,title:a.t("titles.enrollment_details","Enrollment Details")}).dialog("open"),!1}),b(".user_list .edit_section_link").click(function(a){a.preventDefault();var c=b(this);$user=c.closest(".user"),$user.find(".section").toggle(),$user.find(".enrollment_course_section_form").toggle()}),b(".user_list .enrollment_course_section_form #course_section_id").change(function(c){var d=b(this).parent("form"),e=b(this),f=d.prev(".section");b.ajaxJSON(d.attr("action"),"POST",d.getFormData(),function(a){f.html(e.find('option[value="'+e.val()+'"]').html()),f.toggle(),d.toggle()},function(c){b.flashError(a.t("errors.move_user","Something went wrong moving the user to the new section. Please try again later."))})}),j.find(".re_send_invitation_link").click(function(c){c.preventDefault();var d=b(this);d.text(a.t("links.re_sending_invitation","Re-Sending Invitation..."));var e=d.attr("href");b.ajaxJSON(e,"POST",{},function(b){j.fillTemplateData({data:{invitation_sent_at:a.t("invitation_sent_now","Just Now")}}),d.text(a.t("invitation_sent","Invitation Sent!"));var c=j.data("user");c&&c.fillTemplateData({data:{invitation_sent_at:a.t("invitation_sent_now","Just Now")}})},function(b){d.text(a.t("errors.invitation","Invitation Failed.  Please try again."))})}),b(".date_entry").date_field(),b().data("current_default_wiki_editing_roles",b("#course_default_wiki_editing_roles").val()),b("#course_default_wiki_editing_roles").change(function(){var a=b(this);b(".changed_default_wiki_editing_roles").showIf(a.val()!=b().data("current_default_wiki_editing_roles")),b(".default_wiki_editing_roles_change").text(a.find(":selected").text())}),b(".re_send_invitations_link").click(function(c){c.preventDefault();var d=b(this),e=a.t("links.re_send_all","Re-Send All Unaccepted Invitations");d.text(a.t("buttons.re_sending_all","Re-Sending Unaccepted Invitations...")).attr("disabled",!0),b.ajaxJSON(d.attr("href"),"POST",{},function(c){d.text(a.t("buttons.re_sent_all","Re-Sent All Unaccepted Invitations!")).attr("disabled",!1),b(".user_list .user.pending").each(function(){var c=b(this);c.fillTemplateData({data:{invitation_sent_at:a.t("invitation_sent_now","Just Now")}})}),setTimeout(function(){d.text(e)},2500)},function(){d.text(a.t("errors.re_send_all","Send Failed, Please Try Again")).attr("disabled",!1)})}),b("#enrollment_type").change(function(){b(".teacherless_invite_message").showIf(b(this).find(":selected").hasClass("teacherless_invite"))}),b(".is_public_checkbox").change(function(){b(".public_options").showIf(b(this).attr("checked"))}).change(),b(".self_enrollment_checkbox").change(function(){b(".open_enrollment_holder").showIf(b(this).attr("checked"))}).change(),b("#publish_grades_link").click(function(a){a.preventDefault(),c.publish()}),typeof sisPublishEnabled!="undefined"&&sisPublishEnabled&&c.checkup(),b(".reset_course_content_button").click(function(c){c.preventDefault(),b("#reset_course_content_dialog").dialog("close").dialog({autoOpen:!1,title:a.t("titles.reset_course_content_dialog_help","Reset Course Content"),width:500}).dialog("open")}),b("#reset_course_content_dialog .cancel_button").click(function(){b("#reset_course_content_dialog").dialog("close")}),b.scrollSidebar()})}),define("course_settings",function(){}),require(["i18n","jquery","jquery.instructure_forms","jquery.instructure_jquery_patches","jquery.instructure_misc_plugins","jquery.templateData"],function(a,b){a=a.scoped("external_tools"),b(document).ready(function(){var c=b("#external_tools_dialog");b(".add_tool_link").click(function(d){d.preventDefault();var e={domain:"",url:"",config_url:"",config_xml:"",description:"",name:"",custom_fields_string:"",privacy:"anonymous",consumer_key:"",shared_secret:""};c.dialog("close").dialog({autoOpen:!1,title:a.t("titles.edit_external_tool","Edit External Tool"),width:600,height:420}).dialog("open"),c.find(".shared_secret_note").hide(),c.find("form").attr("method","POST").attr("action",c.find(".external_tools_url").attr("href")),c.fillFormData(e,{object_name:"external_tool"}),c.find(".config_type_option").show(),b("#external_tool_match_by").val("domain").change(),b("#external_tool_config_type").val("manual").change()}),c.find("form").formSubmit({beforeSubmit:function(c){b(this).find("button").attr("disabled",!0).filter(".save_button").text(a.t("messages.saving_tool_settings","Saving Tool Settings..."))},success:function(d){b(this).find("button").attr("disabled",!1).filter(".save_button").text(a.t("buttons.save_tool_settings","Save Tool Settings")),c.dialog("close");var e=b("#external_tool_"+d.id);e.length==0&&(e=b("#external_tool_blank").clone(!0).removeAttr("id"),b("#external_tools").append(e)),e.fillTemplateData({data:d,dataValues:["id","workflow_state"],hrefValues:["id"],id:"external_tool_"+d.id}),e.toggleClass("has_editor_button",d.has_editor_button).toggleClass("has_resource_selection",d.has_resource_selection).toggleClass("has_course_navigation",d.has_course_navigation).toggleClass("has_user_navigation",d.has_user_navigation).toggleClass("has_account_navigation",d.has_account_navigation),e.find(".tool_url").showIf(d.url).end().find(".tool_domain").showIf(d.domain),e.show()},error:function(c){b(this).find("button").attr("disabled",!1).filter(".save_button").text(a.t("errors.save_tool_settings_failed","Save Tool Settings Failed"))}}),c.find(".cancel_button").click(function(){c.dialog("close")}),b("#external_tools").delegate(".edit_tool_link","click",function(d){d.preventDefault();var e=b(this).parents(".external_tool"),f=e.getTemplateData({textValues:["name","description","domain","url","consumer_key","custom_fields_string"],dataValues:["id","workflow_state"]});f.privacy_level=f.workflow_state,b("#external_tool_match_by").val(f.url?"url":"domain").change(),c.find(".shared_secret_note").show(),c.find("form").attr("method","PUT").attr("action",e.find(".update_tool_url").attr("rel")),c.fillFormData(f,{object_name:"external_tool"}),c.dialog("close").dialog({autoOpen:!1,title:a.t("titles.edit_external_tool","Edit External Tool"),width:600,height:420}).dialog("open"),c.find(".config_type_option").hide(),b("#external_tool_config_type").val("manual").change()}).delegate(".delete_tool_link","click",function(c){c.preventDefault();var d=b(this).parents(".external_tool"),e=d.find(".update_tool_url").attr("rel");d.confirmDelete({url:e,message:a.t("prompts.remove_tool","Are you sure you want to remove this tool?  Any courses using this tool will no longer work."),success:function(){b(this).slideUp(function(){b(this).remove()})}})}),b("#external_tool_match_by").change(function(){b(this).val()=="url"?b(this).parents("form").find(".tool_domain").hide().find(":text").val("").end().end().find(".tool_url").show():b(this).parents("form").find(".tool_url").hide().find(":text").val("").end().end().find(".tool_domain").show()}),b("#external_tool_config_type").change(function(a){b("#external_tool_form .config_type").hide(),b("#external_tool_form .config_type."+b(this).val()).show()})})}),define("external_tools",function(){}),require(["i18n","jquery","jquery.ajaxJSON","jquery.instructure_forms","jquery.instructure_jquery_patches","jquery.instructure_misc_plugins","jquery.rails_flash_notifications","jquery.templateData","vendor/jquery.scrollTo"],function(a,b){a=a.scoped("grading_standards"),b(document).ready(function(){b(".add_standard_link").click(function(a){a.preventDefault();var c=b("#grading_standard_blank").clone(!0).attr("id","grading_standard_new");b("#standards").append(c.show()),c.find(".edit_grading_standard_link").click()}),b(".edit_letter_grades_link").click(function(c){c.preventDefault(),b("#edit_letter_grades_form").dialog("close").dialog({title:a.t("titles.grading_scheme_info","View/Edit Grading Scheme"),autoOpen:!1,width:600,height:310}).dialog("open")}),b(".grading_standard .delete_grading_standard_link").click(function(c){c.preventDefault();var d=b(this).parents(".grading_standard"),e=d.find(".update_grading_standard_url").attr("href");d.confirmDelete({url:e,message:a.t("confirm.delete_grading_scheme","Are you sure you want to delete this grading scheme?"),success:function(a){b(this).slideUp(function(){b(this).remove()})},error:function(){b.flashError(a.t("errors.cannot_delete_grading_scheme","There was a problem deleting this grading scheme"))}})}),b(".grading_standard .remove_grading_standard_link").click(function(c){function h(){b("#edit_assignment_form .grading_standard_id").val(""),b("#assignment_grading_type").val("points").change(),b("#course_grading_standard_enabled").attr("checked",!1).change(),b("#course_form .grading_scheme_set").text(a.t("grading_scheme_not_set","Not Set")),e.addClass("editing"),e.find(".update_grading_standard_url").attr("href",b("#update_grading_standard_url").attr("href"));var c=b.parseJSON(b("#default_grading_standard_data").val()),d={title:"",id:null,data:c};e.fillTemplateData({data:d,id:"grading_standard_blank",avoid:".find_grading_standard",hrefValues:["id"]}).find(".edit_grading_standard_link").removeClass("read_only"),e.triggerHandler("grading_standard_updated",d),b("#edit_letter_grades_form").dialog("close"),e.undim()}c.preventDefault();var d=confirm(a.t("confirm.unlink_grading_scheme","Are you sure you want to unlink this grading scheme?"));if(!d)return!1;var e=b(this).parents(".grading_standard");e.dim();var f={"assignment[grading_standard_id]":"","assignment[grading_type]":"points"},g=b("#edit_assignment_form").attr("action");b("#update_course_url").length?(f={"course[grading_standard_id]":""},g=b("#update_course_url").attr("href")):g&&g.match(/assignments$/)&&(g=null),g?b.ajaxJSON(g,"PUT",f,h,function(){b.flashError(a.t("errors.cannot_remove_grading_scheme","There was a problem removing this grading scheme.  Please reload the page and try again."))}):h()}),b(".grading_standard .edit_grading_standard_link").click(function(a){a.preventDefault();var c=b(this).parents(".grading_standard");c.addClass("editing"),b(this).hasClass("read_only")&&c.attr("id","grading_standard_blank"),c.find(".grading_standard_row").each(function(){var a=b(this).getTemplateData({textValues:["min_score","name"]});b(this).find(".standard_value").val(a.min_score).end().find(".standard_name").val(a.name)}),b("#standards").ifExists(function(){b("html,body").scrollTo(c)}),c.find(":text:first").blur().focus().select()}),b(".grading_standard .grading_standard_brief").find(".collapse_data_link,.expand_data_link").click(function(a){a.preventDefault();var c=b(this).parents(".grading_standard_brief");c.find(".collapse_data_link,.expand_data_link").toggle(),c.find(".details").slideToggle()}),b(".grading_standard_select").live("click",function(a){a.preventDefault();var c=b(this).getTemplateData({textValues:["id"]}).id;b(".grading_standard .grading_standards_select .grading_standard_select").removeClass("selected_side_tab"),b(this).addClass("selected_side_tab"),b(".grading_standard .grading_standards .grading_standard_brief").hide(),b("#grading_standard_brief_"+c).show()}),b(".grading_standard").find(".find_grading_standard_link,.cancel_find_grading_standard_link").click(function(c){c.preventDefault(),b(this).parents(".grading_standard").find(".display_grading_standard,.find_grading_standard").toggle();var d=b(this).parents(".grading_standard").find(".find_grading_standard:visible");if(d.length>0&&!d.hasClass("loaded")){d.find(".loading_message").text(a.t("status.loading_grading_standards","Loading Grading Standards..."));var e=d.find(".grading_standards_url").attr("href");b.ajaxJSON(e,"GET",{},function(b){if(b.length===0)d.find(".loading_message").text(a.t("no_grading_standards","No grading standards found"));else{d.find(".loading_message").remove();for(var c in b){var e=b[c].grading_standard;e.user_name=e.display_name;var f=d.find(".grading_standards_select .grading_standard_select.blank:first").clone(!0);f.fillTemplateData({data:e}).data("context_code",e.context_code).removeClass("blank"),d.find(".grading_standards_select").append(f.show());var g=d.find(".grading_standard_brief.blank:first").clone(!0);g.fillTemplateData({data:e,id:"grading_standard_brief_"+e.id}).data("context_code",e.context_code),g.removeClass("blank");for(var h=0;h<e.data.length;h++){var i=e.data[h],j={name:i[0],value:h==0?100:"< "+e.data[h-1][1]*100,next_value:i[1]*100},k=g.find(".details_row.blank:first").clone(!0);k.removeClass("blank"),k.fillTemplateData({data:j}),g.find(".details > table").append(k.show())}d.find(".grading_standards").append(g)}d.find(".grading_standards_select .grading_standard_select:visible:first a:first").click()}d.addClass("loaded"),d.find(".grading_standards_holder").slideDown()},function(b){d.find(".loading_message").text(a.t("errors.cannot_load_grading_standards","Loading Grading Standards Failed.  Please Try Again"))})}}),b(".grading_standard .grading_standard_brief .select_grading_standard_link").click(function(a){a.preventDefault();var c=b(this).parents(".grading_standard_brief"),d=c.getTemplateData({textValues:["id","title"],dataValues:["context_code"]}),e=d.id,f=d.title,g=[];b(this).parents(".grading_standard_brief").find(".details_row:not(.blank)").each(function(){var a=b(this).find(".name").text(),c=parseFloat(b(this).find(".next_value").text())/100;isNaN(c)&&(c=""),g.push([a,c])}),b(this).parents(".grading_standard").triggerHandler("grading_standard_updated",{id:e,data:g,title:f});var h=b("#edit_letter_grades_form").data().context_code;b(this).parents(".grading_standard").find(".edit_grading_standard_link").toggleClass("read_only",h!=d.context_code),b(this).parents(".find_grading_standard").find(".cancel_find_grading_standard_link").click()}),b(".grading_standard .cancel_button").click(function(a){b(this).parents(".grading_standard").removeClass("editing").find(".insert_grading_standard").hide();var c=b(this).parents(".grading_standard");c.find(".to_add").remove(),c.find(".to_delete").removeClass("to_delete").show(),c.attr("id")=="grading_standard_new"&&c.remove()}),b(".grading_standard").bind("grading_standard_updated",function(c,d){var e=b(this);e.addClass("editing"),e.find(".update_grading_standard_url").attr("href",b("#update_grading_standard_url").attr("href")),e.fillTemplateData({data:d,id:"grading_standard_"+(d.id||"blank"),avoid:".find_grading_standard",hrefValues:["id"]}).fillFormData(d,{object_name:"grading_standard"});var f=e.find(".insert_grading_standard:first").clone(!0),g=e.find(".grading_standard_row:first").clone(!0).removeClass("blank"),h=e.find(".grading_standard_data");h.empty(),h.append(f.clone(!0).show());for(var i in d.data){var j=g.clone(!0),k=d.data[i];j.removeClass("to_delete").removeClass("to_add"),j.find(".standard_name").val(k[0]).attr("name","grading_standard[standard_data][scheme_"+i+"][name]").end().find(".standard_value").val(k[1]*100).attr("name","grading_standard[standard_data][scheme_"+i+"][value]"),h.append(j.show()),h.append(f.clone(!0).show())}h.find(":text:first").blur(),h.append(g.hide()),h.append(f.hide()),e.find(".grading_standard_row").each(function(){b(this).find(".name").text(b(this).find(".standard_name").val()).end().find(".min_score").text(b(this).find(".standard_value").val()).end().find(".max_score").text(b(this).find(".edit_max_score").text())}),e.removeClass("editing"),e.find(".insert_grading_standard").hide();if(d.id){e.find(".remove_grading_standard_link").removeClass("read_only");var l={"assignment[grading_standard_id]":d.id,"assignment[grading_type]":"letter_grade"},m=b("#edit_assignment_form").attr("action");b("#edit_assignment_form .grading_standard_id").val(d.id),b("#update_course_url").length?(l={"course[grading_standard_id]":d.id},m=b("#update_course_url").attr("href")):m&&m.match(/assignments$/)&&(m=null),m&&b.ajaxJSON(m,"PUT",l,function(c){b("#course_form .grading_scheme_set").text(c&&c.course&&c.course.grading_standard_title||a.t("grading_scheme_currently_set","Currently Set"))},function(){})}else e.find(".remove_grading_standard_link").addClass("read_only")}),b(".grading_standard .save_button").click(function(c){var d=b(this).parents(".grading_standard"),e=b("#edit_letter_grades_form .create_grading_standard_url,#create_grading_standard_url").attr("href"),f="POST";d.attr("id")!="grading_standard_blank"&&d.attr("id")!="grading_standard_new"&&(e=b(this).parents(".grading_standard").find(".update_grading_standard_url").attr("href"),f="PUT");var g=d.find(".standard_title,.grading_standard_row:visible").getFormData();d.find("button").attr("disabled",!0).filter(".save_button").text(a.t("status.saving","Saving...")),b.ajaxJSON(e,f,g,function(b){var c=b.grading_standard;d.find("button").attr("disabled",!1).filter(".save_button").text(a.t("buttons.save","Save")),d.triggerHandler("grading_standard_updated",c)},function(){d.find("button").attr("disabled",!1).filter(".save_button").text(a.t("errors.save_failed","Save Failed"))})}),b(".grading_standard thead").mouseover(function(a){if(!b(this).parents(".grading_standard").hasClass("editing"))return;b(this).parents(".grading_standard").find(".insert_grading_standard").hide(),b(this).parents(".grading_standard").find(".insert_grading_standard:first").show()}),b(".grading_standard .grading_standard_row").mouseover(function(a){if(!b(this).parents(".grading_standard").hasClass("editing"))return;b(this).parents(".grading_standard").find(".insert_grading_standard").hide();var c=a.pageY,d=b(this).offset(),e=b(this).height();c>d.top+e/2?b(this).next(".insert_grading_standard").show():b(this).prev(".insert_grading_standard").show()}),b(".grading_standard .insert_grading_standard_link").click(function(a){a.preventDefault();if(b(this).parents(".grading_standard").find(".grading_standard_row").length>40)return;var c=b(this).parents(".grading_standard"),d=c.find(".grading_standard_row:first").clone(!0).removeClass("blank"),e=c.find(".insert_grading_standard:first").clone(!0),f=null;while(!f||b(".standard_name[name='grading_standard[standard_data][scheme_"+f+"][name]']").length>0)f=Math.round(Math.random()*1e4);d.find(".standard_name").val("-").attr("name","grading_standard[standard_data][scheme_"+f+"][name]"),d.find(".standard_value").attr("name","grading_standard[standard_data][scheme_"+f+"][value]"),b(this).parents(".insert_grading_standard").after(d.show()),d.after(e),c.find(":text:first").blur(),d.find(":text:first").focus().select(),d.addClass("to_add")}),b(".grading_standard .delete_row_link").click(function(a){a.preventDefault();if(b(this).parents(".grading_standard").find(".grading_standard_row:visible").length<2)return;var c=b(this).parents(".grading_standard_row");c.prev(".insert_grading_standard").length>0?c.prev(".insert_grading_standard").remove():c.next(".insert_grading_standard").remove(),c.fadeOut(function(){b(this).addClass("to_delete"),b(".grading_standard input[type='text']:first").triggerHandler("change")})}),b(".grading_standard input[type='text']").bind("blur change",function(){var a=b(this).parents(".grading_standard"),c=parseFloat(b(this).parents(".grading_standard_row").find(".standard_value").val());c=Math.round(c*10)/10,b(this).parents(".grading_standard_row").find(".standard_value").val(c),isNaN(c)&&(c=null);var d=c||100,e=c||0,f=a.find(".grading_standard_row:not(.blank,.to_delete)");for(var g=f.index(b(this).parents(".grading_standard_row"))+1;g<f.length;g++){var h=f.eq(g),i=parseFloat(h.find(".standard_value").val());isNaN(i)&&(i=null);if(g==f.length-1)i=0;else if(!i||i>d-.1)i=parseInt(d)-1;h.find(".standard_value").val(i),d=i}for(var g=f.index(b(this).parents(".grading_standard_row"))-1;g>=0;g--){var h=f.eq(g),i=parseFloat(h.find(".standard_value").val());isNaN(i)&&(i=null);if(g==f.length-1)i=0;else if(!i||i<e+.1)i=parseInt(e)+1;e=i,h.find(".standard_value").val(i)}d=100,f.each(function(a){var c=parseFloat(b(this).find(".standard_value").val()),a=f.index(this);isNaN(c)&&(c=null);if(a==f.length-1)c=0;else if(!c||c>d-.1)c=parseInt(d)-1;b(this).find(".standard_value").val(c),d=c}),e=0;for(var g=f.length-1;g>=0;g--){var h=f.eq(g),i=parseFloat(h.find(".standard_value").val());isNaN(i)&&(i=null);if(g==f.length-1)i=0;else if(!i||i<e+.1)i=parseInt(e)+1;e=i,h.find(".standard_value").val(i)}f.each(function(a){var c=f.eq(a-1),d=0;c&&c.length>0&&(d=parseFloat(c.find(".standard_value").val()),isNaN(d)&&(d=0),b(this).find(".edit_max_score").text("< "+d))}),f.filter(":first").find(".edit_max_score").text(100)})})}),define("grading_standards",function(){}),function(){require(["vendor/jquery.cookie","user_lists","course_settings","external_tools","grading_standards"])}.call(this),define("compiled/bundles/course_settings",function(){})