require(["i18n","jquery","jquery.ajaxJSON","jquery.instructure_forms","jqueryui/progressbar"],function(a,b){a=a.scoped("content_exports"),b(document).ready(function(c){function f(){b("#exporter_form").html(a.t("messages.processing","Processing")+"<div style='font-size: 0.8em;'>"+a.t("messages.this_may_take_a_bit","this may take a bit...")+"</div>").attr("disabled",!0),b(".instruction").hide(),b(".progress_bar_holder").slideDown(),b(".export_progress").progressbar(),d="nothing";var c=0,f=function(){if(d=="nothing"){c++;var a=(b(".export_progress").progressbar("option","value")||0)+.25;c<10&&b(".export_progress").progressbar("option","value",a),setTimeout(f,2e3)}else d="nothing",c=0,setTimeout(f,1e4)},g=function(){var c=null,f=1500;b.ajaxJSON(location.href+"/"+e,"GET",{},function(e){d="updating";var h=e.content_export,i=0;h&&(i=Math.max(b(".export_progress").progressbar("option","value")||0,h.progress),b(".export_progress").progressbar("option","value",i));if(h.workflow_state=="exported")b("#exporter_form").hide(),b(".export_progress").progressbar("option","value",100),b(".progress_message").html("The course has been exported."),b("#exports").append("<p>"+a.t("labels.new_course_export","New Course Export:")+' <a href="'+h.download_url+'">'+a.t("links.download_plain","Click here to download")+"</a> </p>");else if(h.workflow_state=="failed"){code="content_export_"+h.id,b(".progress_bar_holder").hide(),b("#exporter_form").hide();var j=a.t("errors.error",'There was an error exporting your course.  Please notify your system administrator and give them the following export identifier: "%{code}"',{code:code});b(".export_messages .error_message").html(j),b(".export_messages").show()}else i==c?f=Math.max(f+500,3e4):f=1500,c=i,setTimeout(g,1500)},function(){setTimeout(g,3e3)})};setTimeout(g,2e3),setTimeout(f,1e3)}function g(){b("#current_export_id").size()&&(e=b("#current_export_id").text(),f())}var d="nothing",e=null;b("#exporter_form").formSubmit({success:function(a){a&&a.content_export?(e=a.content_export.id,f()):(b(".export_messages .error_message").text(a.error_message),b(".export_messages").show())},error:function(c){b(this).find(".submit_button").attr("disabled",!1).text(a.t("buttons.process","Process Data"))}}),g()})}),define("content_exports",function(){}),function(){require(["content_exports"])}.call(this),define("compiled/bundles/content_exports",function(){})