(function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b=Array.prototype.indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(this[b]===a)return b;return-1};define("compiled/helpDialog",["i18n","jst/helpDialog","INST","jquery.instructure_misc_helpers","jquery.instructure_jquery_patches","jquery.disableWhileLoading"],function(c,d,e){var f;return c=c.scoped("HelpDialog"),f={defaultLinks:[{available_to:["student"],text:c.t("instructor_question","Ask your instructor a question"),subtext:c.t("instructor_question_sub","Questions are submitted to your instructor"),url:"#teacher_feedback"},{available_to:["student","teacher","admin"],text:c.t("search_the_canvas_guides","Search the Canvas Guides"),subtext:c.t("canvas_help_sub","Find answers to common questions"),url:"http://guides.instructure.com"},{available_to:["user","student","teacher","admin"],text:c.t("report_problem","Report a problem"),subtext:c.t("report_problem_sub","If Canvas misbehaves, tell us about it"),url:"#create_ticket"}],defaultTitle:c.t("Help","Help"),initDialog:function(){return this.$dialog=$('<div style="padding:0; overflow: visible;" />').dialog({resizable:!1,width:400,title:this.defaultTitle,close:a(function(){return this.switchTo("#help-dialog-options")},this)}),this.$dialog.dialog("widget").delegate('a[href="#teacher_feedback"],                                          a[href="#create_ticket"],                                          a[href="#help-dialog-options"]',"click",a(function(a){return a.preventDefault(),this.switchTo($(a.currentTarget).attr("href"))},this)),this.helpLinksDfd=$.getJSON("/help_links").done(a(function(a){var c;return a=$.grep(this.defaultLinks.concat(a),function(a){return $.detect(a.available_to,function(a){return b.call(ENV.current_user_roles,a)>=0})}),c={showEmail:!ENV.current_user_id,helpLinks:a,showBadBrowserMessage:e.browser.ie,browserVersion:e.browser.version},this.$dialog.html(d(c)),this.initTicketForm(),$(this).trigger("ready")},this)),this.$dialog.disableWhileLoading(this.helpLinksDfd),this.dialogInited=!0},initTicketForm:function(){var b;return b=this.$dialog.find("#create_ticket").formSubmit({disableWhileLoading:!0,required:["error[subject]","error[comments]","error[user_perceived_severity]"],success:a(function(){return this.$dialog.dialog("close"),b.find(":input").val("")},this)})},switchTo:function(b){var d,e,f;return f="#teacher_feedback, #create_ticket",this.$dialog.find(f).hide(),d=this.$dialog.find(b).show().outerHeight(),this.$dialog.animate({left:f.match(b)?-400:0,height:d},{step:a(function(){return this.$dialog.dialog("option","position","center")},this),duration:100}),(e=this.$dialog.find("a[href='"+b+"'] .text").text())?e=$("          <a class='ui-dialog-header-backlink' href='#help-dialog-options'>            "+c.t("Back","Back")+"          </a>          <span>"+e+"</span>        "):e=this.defaultTitle,this.$dialog.dialog("option","title",e)},open:function(){return this.dialogInited||this.initDialog(),this.$dialog.dialog("open"),this.initTeacherFeedback()},initTeacherFeedback:function(){var c,d;if(!this.teacherFeedbackInited&&b.call(ENV.current_user_roles,"student")>=0)return this.teacherFeedbackInited=!0,d=$.getJSON("/api/v1/courses.json"),c=null,this.helpLinksDfd.done(a(function(){return c=this.$dialog.find("#teacher_feedback").disableWhileLoading(d).formSubmit({disableWhileLoading:!0,required:["recipients[]","body"],success:a(function(){return this.$dialog.dialog("close")},this)})},this)),$.when(d,this.helpLinksDfd).done(function(a){var b,d;return d=function(){var c,d,e,f;e=a[0],f=[];for(c=0,d=e.length;c<d;c++)b=e[c],f.push("<option value='course_"+b.id+"_admins' "+(ENV.context_id===b.id?"selected":"")+">                      "+$.htmlEscape(b.name)+"                    </option>");return f}(),c.find('[name="recipients[]"]').html(d.join(""))})},initTriggers:function(){return $(".help_dialog_trigger").click(a(function(a){return a.preventDefault(),this.open()},this))}}})}).call(this)