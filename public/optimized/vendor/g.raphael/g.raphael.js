(function(){Raphael.fn.g=Raphael.fn.g||{},Raphael.fn.g.markers={disc:"disc",o:"disc",flower:"flower",f:"flower",diamond:"diamond",d:"diamond",square:"square",s:"square",triangle:"triangle",t:"triangle",star:"star","*":"star",cross:"cross",x:"cross",plus:"plus","+":"plus",arrow:"arrow","->":"arrow"},Raphael.fn.g.shim={stroke:"none",fill:"#000","fill-opacity":0},Raphael.fn.g.txtattr={font:"12px Arial, sans-serif"},Raphael.fn.g.colors=[];var a=[.6,.2,.05,.1333,.75,0];for(var b=0;b<10;b++)b<a.length?Raphael.fn.g.colors.push("hsb("+a[b]+", .75, .75)"):Raphael.fn.g.colors.push("hsb("+a[b-a.length]+", 1, .5)");Raphael.fn.g.text=function(a,b,c){return this.text(a,b,c).attr(this.g.txtattr)},Raphael.fn.g.labelise=function(a,b,c){return a?(a+"").replace(/(##+(?:\.#+)?)|(%%+(?:\.%+)?)/g,function(a,d,e){if(d)return(+b).toFixed(d.replace(/^#+\.?/g,"").length);if(e)return(b*100/c).toFixed(e.replace(/^%+\.?/g,"").length)+"%"}):(+b).toFixed(0)},Raphael.fn.g.finger=function(a,b,c,d,e,f,g){if(e&&!d||!e&&!c)return g?"":this.path();f={square:"square",sharp:"sharp",soft:"soft"}[f]||"round";var h;d=Math.round(d),c=Math.round(c),a=Math.round(a),b=Math.round(b);switch(f){case"round":if(!e){var i=Math.floor(d/2);c<i?(i=c,h=["M",a+.5,b+.5-Math.floor(d/2),"l",0,0,"a",i,Math.floor(d/2),0,0,1,0,d,"l",0,0,"z"]):h=["M",a+.5,b+.5-i,"l",c-i,0,"a",i,i,0,1,1,0,d,"l",i-c,0,"z"]}else{var i=Math.floor(c/2);d<i?(i=d,h=["M",a-Math.floor(c/2),b,"l",0,0,"a",Math.floor(c/2),i,0,0,1,c,0,"l",0,0,"z"]):h=["M",a-i,b,"l",0,i-d,"a",i,i,0,1,1,c,0,"l",0,d-i,"z"]}break;case"sharp":if(!e){var j=Math.floor(d/2);h=["M",a,b+j,"l",0,-d,Math.max(c-j,0),0,Math.min(j,c),j,-Math.min(j,c),j+(j*2<d),"z"]}else{var j=Math.floor(c/2);h=["M",a+j,b,"l",-c,0,0,-Math.max(d-j,0),j,-Math.min(j,d),j,Math.min(j,d),j,"z"]}break;case"square":e?h=["M",a+Math.floor(c/2),b,"l",1-c,0,0,-d,c-1,0,"z"]:h=["M",a,b+Math.floor(d/2),"l",0,-d,c,0,0,d,"z"];break;case"soft":var i;e?(i=Math.min(Math.round(c/5),d),h=["M",a-Math.floor(c/2),b,"l",0,i-d,"a",i,i,0,0,1,i,-i,"l",c-2*i,0,"a",i,i,0,0,1,i,i,"l",0,d-i,"z"]):(i=Math.min(c,Math.round(d/5)),h=["M",a+.5,b+.5-Math.floor(d/2),"l",c-i,0,"a",i,i,0,0,1,i,i,"l",0,d-i*2,"a",i,i,0,0,1,-i,i,"l",i-c,0,"z"])}return g?h.join(","):this.path(h)},Raphael.fn.g.disc=function(a,b,c){return this.circle(a,b,c)},Raphael.fn.g.line=function(a,b,c){return this.rect(a-c,b-c/5,2*c,2*c/5)},Raphael.fn.g.square=function(a,b,c){return c*=.7,this.rect(a-c,b-c,2*c,2*c)},Raphael.fn.g.triangle=function(a,b,c){return c*=1.75,this.path("M".concat(a,",",b,"m0-",c*.58,"l",c*.5,",",c*.87,"-",c,",0z"))},Raphael.fn.g.diamond=function(a,b,c){return this.path(["M",a,b-c,"l",c,c,-c,c,-c,-c,c,-c,"z"])},Raphael.fn.g.flower=function(a,b,c,d){c*=1.25;var e=c,f=e*.5;d=+d<3||!d?5:d;var g=["M",a,b+f,"Q"],h;for(var i=1;i<d*2+1;i++)h=i%2?e:f,g=g.concat([+(a+h*Math.sin(i*Math.PI/d)).toFixed(3),+(b+h*Math.cos(i*Math.PI/d)).toFixed(3)]);return g.push("z"),this.path(g.join(","))},Raphael.fn.g.star=function(a,b,c,d){d=d||c*.5;var e=["M",a,b+d,"L"],f;for(var g=1;g<10;g++)f=g%2?c:d,e=e.concat([(a+f*Math.sin(g*Math.PI*.2)).toFixed(3),(b+f*Math.cos(g*Math.PI*.2)).toFixed(3)]);return e.push("z"),this.path(e.join(","))},Raphael.fn.g.cross=function(a,b,c){return c/=2.5,this.path("M".concat(a-c,",",b,"l",[-c,-c,c,-c,c,c,c,-c,c,c,-c,c,c,c,-c,c,-c,-c,-c,c,-c,-c,"z"]))},Raphael.fn.g.plus=function(a,b,c){return c/=2,this.path("M".concat(a-c/2,",",b-c/2,"l",[0,-c,c,0,0,c,c,0,0,c,-c,0,0,c,-c,0,0,-c,-c,0,0,-c,"z"]))},Raphael.fn.g.arrow=function(a,b,c){return this.path("M".concat(a-c*.7,",",b-c*.4,"l",[c*.6,0,0,-c*.4,c,c*.8,-c,c*.8,0,-c*.4,-c*.6,0],"z"))},Raphael.fn.g.tag=function(a,b,c,d,e){d=d||0,e=e==null?5:e,c=c==null?"$9.99":c;var f=.5522*e,g=this.set(),h=3;return g.push(this.path().attr({fill:"#000",stroke:"none"})),g.push(this.text(a,b,c).attr(this.g.txtattr).attr({fill:"#fff"})),g.update=function(){this.rotate(0,a,b);var c=this[1].getBBox();if(c.height<e*2){var g=Math.sqrt(Math.pow(e+h,2)-Math.pow(c.height/2+h,2));this[0].attr({path:["M",a,b+e,"c",-f,0,-e,f-e,-e,-e,0,-f,e-f,-e,e,-e,f,0,e,e-f,e,e,0,f,f-e,e,-e,e,"M",a+g,b-c.height/2-h,"a",e+h,e+h,0,1,0,0,c.height+2*h,"l",e+h-g+c.width+2*h,0,0,-c.height-2*h,"L",a+g,b-c.height/2-h].join(",")})}else this[0].attr({path:["M",a,b+e,"a",e,e,0,1,1,0,-e*2,e,e,0,1,1,0,e*2,"m",0,-e*2-h,"a",e+h,e+h,0,1,0,0,(e+h)*2,"L",a+e+h,b+c.height/2+h,"l",c.width+2*h,0,0,-c.height-2*h,-c.width-2*h,0,"L",a,b-e-h].join(",")});return this[1].attr({x:a+e+h+c.width/2,y:b}),d=(360-d)%360,this.rotate(d,a,b),d>90&&d<270&&this[1].attr({x:a-e-h-c.width/2,y:b,rotation:[180+d,a,b]}),this},g.update(),g},Raphael.fn.g.popupit=function(a,b,c,d,e){d=d==null?2:d,e=e||5,a=Math.round(a)+.5,b=Math.round(b)+.5;var f=c.getBBox(),g=Math.round(f.width/2),h=Math.round(f.height/2),i=[0,g+e*2,0,-g-e*2],j=[-h*2-e*3,-h-e,0,-h-e],k=["M",a-i[d],b-j[d],"l",-e,(d==2)*-e,-Math.max(g-e,0),0,"a",e,e,0,0,1,-e,-e,"l",0,-Math.max(h-e,0),(d==3)*-e,-e,(d==3)*e,-e,0,-Math.max(h-e,0),"a",e,e,0,0,1,e,-e,"l",Math.max(g-e,0),0,e,!d*-e,e,!d*e,Math.max(g-e,0),0,"a",e,e,0,0,1,e,e,"l",0,Math.max(h-e,0),(d==1)*e,e,(d==1)*-e,e,0,Math.max(h-e,0),"a",e,e,0,0,1,-e,e,"l",-Math.max(g-e,0),0,"z"].join(","),l=[{x:a,y:b+e*2+h},{x:a-e*2-g,y:b},{x:a,y:b-e*2-h},{x:a+e*2+g,y:b}][d];return c.translate(l.x-g-f.x,l.y-h-f.y),this.path(k).attr({fill:"#000",stroke:"none"}).insertBefore(c.node?c:c[0])},Raphael.fn.g.popup=function(a,b,c,d,e){d=d==null?2:d,e=e||5,c=c||"$9.99";var f=this.set(),g=3;return f.push(this.path().attr({fill:"#000",stroke:"none"})),f.push(this.text(a,b,c).attr(this.g.txtattr).attr({fill:"#fff"})),f.update=function(c,f,g){c=c||a,f=f||b;var h=this[1].getBBox(),i=h.width/2,j=h.height/2,k=[0,i+e*2,0,-i-e*2],l=[-j*2-e*3,-j-e,0,-j-e],m=["M",c-k[d],f-l[d],"l",-e,(d==2)*-e,-Math.max(i-e,0),0,"a",e,e,0,0,1,-e,-e,"l",0,-Math.max(j-e,0),(d==3)*-e,-e,(d==3)*e,-e,0,-Math.max(j-e,0),"a",e,e,0,0,1,e,-e,"l",Math.max(i-e,0),0,e,!d*-e,e,!d*e,Math.max(i-e,0),0,"a",e,e,0,0,1,e,e,"l",0,Math.max(j-e,0),(d==1)*e,e,(d==1)*-e,e,0,Math.max(j-e,0),"a",e,e,0,0,1,-e,e,"l",-Math.max(i-e,0),0,"z"].join(","),n=[{x:c,y:f+e*2+j},{x:c-e*2-i,y:f},{x:c,y:f-e*2-j},{x:c+e*2+i,y:f}][d];return g?(this[0].animate({path:m},500,">"),this[1].animate(n,500,">")):(this[0].attr({path:m}),this[1].attr(n)),this},f.update(a,b)},Raphael.fn.g.flag=function(a,b,c,d){d=d||0,c=c||"$9.99";var e=this.set(),f=3;return e.push(this.path().attr({fill:"#000",stroke:"none"})),e.push(this.text(a,b,c).attr(this.g.txtattr).attr({fill:"#fff"})),e.update=function(a,b){this.rotate(0,a,b);var c=this[1].getBBox(),e=c.height/2;return this[0].attr({path:["M",a,b,"l",e+f,-e-f,c.width+2*f,0,0,c.height+2*f,-c.width-2*f,0,"z"].join(",")}),this[1].attr({x:a+e+f+c.width/2,y:b}),d=360-d,this.rotate(d,a,b),d>90&&d<270&&this[1].attr({x:a-r-f-c.width/2,y:b,rotation:[180+d,a,b]}),this},e.update(a,b)},Raphael.fn.g.label=function(a,b,c){var d=this.set();return d.push(this.rect(a,b,10,10).attr({stroke:"none",fill:"#000"})),d.push(this.text(a,b,c).attr(this.g.txtattr).attr({fill:"#fff"})),d.update=function(){var a=this[1].getBBox(),b=Math.min(a.width+10,a.height+10)/2;this[0].attr({x:a.x-b/2,y:a.y-b/2,width:a.width+b,height:a.height+b,r:b})},d.update(),d},Raphael.fn.g.labelit=function(a){var b=a.getBBox(),c=Math.min(20,b.width+10,b.height+10)/2;return this.rect(b.x-c/2,b.y-c/2,b.width+c,b.height+c,c).attr({stroke:"none",fill:"#000"}).insertBefore(a[0])},Raphael.fn.g.drop=function(a,b,c,d,e){d=d||30,e=e||0;var f=this.set();return f.push(this.path(["M",a,b,"l",d,0,"A",d*.4,d*.4,0,1,0,a+d*.7,b-d*.7,"z"]).attr({fill:"#000",stroke:"none",rotation:[22.5-e,a,b]})),e=(e+90)*Math.PI/180,f.push(this.text(a+d*Math.sin(e),b+d*Math.cos(e),c).attr(this.g.txtattr).attr({"font-size":d*12/30,fill:"#fff"})),f.drop=f[0],f.text=f[1],f},Raphael.fn.g.blob=function(a,b,c,d,e){d=(+d+1?d:45)+90,e=e||12;var f=Math.PI/180,g=e*12/12,h=this.set();return h.push(this.path().attr({fill:"#000",stroke:"none"})),h.push(this.text(a+e*Math.sin(d*f),b+e*Math.cos(d*f)-g/2,c).attr(this.g.txtattr).attr({"font-size":g,fill:"#fff"})),h.update=function(c,h,i){c=c||a,h=h||b;var j=this[1].getBBox(),k=Math.max(j.width+g,e*25/12),l=Math.max(j.height+g,e*25/12),m=c+e*Math.sin((d-22.5)*f),n=h+e*Math.cos((d-22.5)*f),o=c+e*Math.sin((d+22.5)*f),p=h+e*Math.cos((d+22.5)*f),q=(o-m)/2,r=(p-n)/2,s=k/2,t=l/2,u=-Math.sqrt(Math.abs(s*s*t*t-s*s*r*r-t*t*q*q)/(s*s*r*r+t*t*q*q)),v=u*s*r/t+(o+m)/2,w=u*-t*q/s+(p+n)/2;return i?this.animate({x:v,y:w,path:["M",a,b,"L",o,p,"A",s,t,0,1,1,m,n,"z"].join(",")},500,">"):this.attr({x:v,y:w,path:["M",a,b,"L",o,p,"A",s,t,0,1,1,m,n,"z"].join(",")}),this},h.update(a,b),h},Raphael.fn.g.colorValue=function(a,b,c,d){return"hsb("+[Math.min((1-a/b)*.4,1),c||.75,d||.75]+")"},Raphael.fn.g.snapEnds=function(a,b,c){function f(a){return Math.abs(a-.5)<.25?Math.floor(a)+.5:Math.round(a)}var d=a,e=b;if(d==e)return{from:d,to:e,power:0};var g=(e-d)/c,h=Math.floor(g),i=h,j=0;if(h){while(i)j--,i=Math.floor(g*Math.pow(10,j))/Math.pow(10,j);j++}else{while(!h)j=j||1,h=Math.floor(g*Math.pow(10,j))/Math.pow(10,j),j++;j&&j--}var e=f(b*Math.pow(10,j))/Math.pow(10,j);e<b&&(e=f((b+.5)*Math.pow(10,j))/Math.pow(10,j));var d=f((a-(j>0?0:.5))*Math.pow(10,j))/Math.pow(10,j);return{from:d,to:e,power:j}},Raphael.fn.g.axis=function(a,b,c,e,f,g,h,i,j,k){k=k==null?2:k,j=j||"t",g=g||10;var l=j=="|"||j==" "?["M",a+.5,b,"l",0,.001]:h==1||h==3?["M",a+.5,b,"l",0,-c]:["M",a,b+.5,"l",c,0],m=this.g.snapEnds(e,f,g),n=m.from,o=m.to,p=m.power,q=0,r=this.set();d=(o-n)/g;var s=n,t=p>0?p:0;x=c/g;if(+h==1||+h==3){var u=b,v=(h-1?1:-1)*(k+3+!!(h-1));while(u>=b-c)j!="-"&&j!=" "&&(l=l.concat(["M",a-(j=="+"||j=="|"?k:!(h-1)*k*2),u+.5,"l",k*2+1,0])),r.push(this.text(a+v,u,i&&i[q++]||(Math.round(s)==s?s:+s.toFixed(t))).attr(this.g.txtattr).attr({"text-anchor":h-1?"start":"end"})),s+=d,u-=x;Math.round(u+x-(b-c))&&(j!="-"&&j!=" "&&(l=l.concat(["M",a-(j=="+"||j=="|"?k:!(h-1)*k*2),b-c+.5,"l",k*2+1,0])),r.push(this.text(a+v,b-c,i&&i[q]||(Math.round(s)==s?s:+s.toFixed(t))).attr(this.g.txtattr).attr({"text-anchor":h-1?"start":"end"})))}else{var w=a,s=n,t=p>0?p:0,v=(h?-1:1)*(k+9+!h),x=c/g,y=0,z=0;while(w<=a+c){j!="-"&&j!=" "&&(l=l.concat(["M",w+.5,b-(j=="+"?k:!!h*k*2),"l",0,k*2+1])),r.push(y=this.text(w,b+v,i&&i[q++]||(Math.round(s)==s?s:+s.toFixed(t))).attr(this.g.txtattr));var A=y.getBBox();z<A.x-5?z=A.x+A.width:r.pop(r.length-1).remove(),s+=d,w+=x}Math.round(w-x-a-c)&&(j!="-"&&j!=" "&&(l=l.concat(["M",a+c+.5,b-(j=="+"?k:!!h*k*2),"l",0,k*2+1])),r.push(this.text(a+c,b+v,i&&i[q]||(Math.round(s)==s?s:+s.toFixed(t))).attr(this.g.txtattr)))}var B=this.path(l);return B.text=r,B.all=this.set([B,r]),B.remove=function(){this.text.remove(),this.constructor.prototype.remove.call(this)},B},Raphael.el.lighter=function(a){a=a||2;var b=[this.attrs.fill,this.attrs.stroke];this.fs=this.fs||[b[0],b[1]],b[0]=Raphael.rgb2hsb(Raphael.getRGB(b[0]).hex),b[1]=Raphael.rgb2hsb(Raphael.getRGB(b[1]).hex),b[0].b=Math.min(b[0].b*a,1),b[0].s=b[0].s/a,b[1].b=Math.min(b[1].b*a,1),b[1].s=b[1].s/a,this.attr({fill:"hsb("+[b[0].h,b[0].s,b[0].b]+")",stroke:"hsb("+[b[1].h,b[1].s,b[1].b]+")"})},Raphael.el.darker=function(a){a=a||2;var b=[this.attrs.fill,this.attrs.stroke];this.fs=this.fs||[b[0],b[1]],b[0]=Raphael.rgb2hsb(Raphael.getRGB(b[0]).hex),b[1]=Raphael.rgb2hsb(Raphael.getRGB(b[1]).hex),b[0].s=Math.min(b[0].s*a,1),b[0].b=b[0].b/a,b[1].s=Math.min(b[1].s*a,1),b[1].b=b[1].b/a,this.attr({fill:"hsb("+[b[0].h,b[0].s,b[0].b]+")",stroke:"hsb("+[b[1].h,b[1].s,b[1].b]+")"})},Raphael.el.original=function(){this.fs&&(this.attr({fill:this.fs[0],stroke:this.fs[1]}),delete this.fs)}})()