(function(a){function b(){function e(a){b=a,b.onKeyDown.subscribe(g)}function f(){b.onKeyDown.unsubscribe(g)}function g(e,f){var g;b.getEditorLock().isActive()||(e.which==a.ui.keyCode.ESCAPE&&d&&(e.preventDefault(),i(),c.onCopyCancelled.notify({ranges:d}),d=null),e.which==67&&(e.ctrlKey||e.metaKey)&&(g=b.getSelectionModel().getSelectedRanges(),g.length!=0&&(e.preventDefault(),d=g,h(g),c.onCopyCells.notify({ranges:g}))),e.which==86&&(e.ctrlKey||e.metaKey)&&d&&(e.preventDefault(),i(),g=b.getSelectionModel().getSelectedRanges(),c.onPasteCells.notify({from:d,to:g}),d=null))}function h(a){var c=b.getColumns(),d={};for(var e=0;e<a.length;e++)for(var f=a[e].fromRow;f<=a[e].toRow;f++){d[f]={};for(var g=a[e].fromCell;g<=a[e].toCell;g++)d[f][c[g].id]="copied"}b.setCellCssStyles("copy-manager",d)}function i(){b.removeCellCssStyles("copy-manager")}var b,c=this,d;a.extend(this,{init:e,destroy:f,clearCopySelection:i,onCopyCells:new Slick.Event,onCopyCancelled:new Slick.Event,onPasteCells:new Slick.Event})}a.extend(!0,window,{Slick:{CellCopyManager:b}})})(jQuery)