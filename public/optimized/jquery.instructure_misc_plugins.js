define(["i18n","jquery","jquery.ajaxJSON","jquery.instructure_jquery_patches","jquery.scrollToVisible","vendor/jquery.ba-hashchange","vendor/jquery.scrollTo"],function(a,b){return a=a.scoped("instructure"),b.fn.ifExists=function(a){return this.length&&a.call(this,this),this},b.fn.scrollbarWidth=function(){var a=b('<div style="width:50px;height:50px;overflow:hidden;position:absolute;top:-200px;left:-200px;"><div style="height:100px;"></div>').appendTo(this),c=a.find("div"),d=c.innerWidth();a.css("overflow-y","scroll");var e=c.innerWidth();return a.remove(),d-e},b.fn.dim=function(a){return this.animate({opacity:.4},a)},b.fn.undim=function(a){return this.animate({opacity:1},a)},b.fn.confirmDelete=function(a){var a=b.extend({},b.fn.confirmDelete.defaults,a),c=this,d=!0;a.noMessage=a.noMessage||a.no_message,a.message&&!a.noMessage&&(b.skipConfirmations||(d=confirm(a.message)));if(!d){a.cancelled&&b.isFunction(a.cancelled)&&a.cancelled.call(c);return}a.confirmed||(a.confirmed=function(){c.dim()}),a.confirmed.call(c);if(a.url){a.success||(a.success=function(a){c.fadeOut("slow",function(){c.remove()})});var e={};a.token&&(e.authenticity_token=a.token),e.authenticity_token||(e.authenticity_token=b("#ajax_authenticity_token").text()),b.ajaxJSON(a.url,"DELETE",e,function(b){a.success.call(c,b)},function(d,e,f,g){a.error&&b.isFunction(a.error)?a.error.call(c,d,e,f,g):b.ajaxJSON.unhandledXHRs.push(e)})}else a.success||(a.success=function(){c.fadeOut("slow",function(){c.remove()})}),a.success.call(c)},b.fn.confirmDelete.defaults={message:a.t("confirms.default_delete_thing","Are you sure you want to delete this?")},b.fn.fragmentChange=function(a){if(a&&a!==!0){var c=(window.location.search||"").replace(/^\?/,"").split("&"),d,e=null;for(d in c){var f=c[d];f&&f.indexOf("hash=")===0&&(e="#"+f.substring(5))}this.bind("document_fragment_change",a);var g=this,h=!1;for(d in b._checkFragments.fragmentList){var i=b._checkFragments.fragmentList[d];i.doc[0]==g[0]&&(h=!0)}h||b._checkFragments.fragmentList.push({doc:g,fragment:""}),b(window).bind("hashchange",b._checkFragments),setTimeout(function(){e&&e.length>0?g.triggerHandler("document_fragment_change",e):g&&g[0]&&g[0].location&&g[0].location.hash.length>0&&g.triggerHandler("document_fragment_change",g[0].location.hash)},500)}else this.triggerHandler("document_fragment_change",this[0].location.hash);return this},b._checkFragments=function(){var a=b._checkFragments.fragmentList;for(var c in a){var d=a[c],e=d.doc;e[0].location.hash!=d.fragment&&(e.triggerHandler("document_fragment_change",e[0].location.hash),d.fragment=e[0].location.hash,b._checkFragments.fragmentList[c]=d)}},b._checkFragments.fragmentList=[],b.fn.clickLink=function(){var a=this.eq(0);a.hasClass("disabled_link")||a.click()},b.fn.showIf=function(a){return b.isFunction(a)?this.each(function(c){b(this).showIf(a.call(this))}):(a?this.show():this.hide(),this)},b.fn.disableIf=function(a){return b.isFunction(a)&&(a=a.call(this)),this.prop("disabled",!!a),this},b.fn.indicate=function(a){a=a||{};var c;if(a=="remove"){c=this.data("indicator"),c&&c.remove();return}b(".indicator_box").remove();var d=this.offset();a&&a.offset&&(d=a.offset);var e=this.width(),f=this.height(),g=(a.container||this).zIndex();c=b(document.createElement("div")),c.css({width:e+6,height:f+6,top:d.top-3,left:d.left-3,zIndex:g+1,position:"absolute",display:"block","-moz-border-radius":5,opacity:.8,border:"2px solid #870",backgroundColor:"#fd0"}),c.addClass("indicator_box"),c.mouseover(function(){b(this).stop().fadeOut("fast",function(){b(this).remove()})}),this.data("indicator")&&this.indicate("remove"),this.data("indicator",c),b("body").append(c),a&&a.singleFlash?c.hide().fadeIn().animate({opacity:.8},500).fadeOut("slow",function(){b(this).remove()}):c.hide().fadeIn().animate({opacity:.8},500).fadeOut("slow").fadeIn("slow").animate({opacity:.8},2500).fadeOut("slow",function(){b(this).remove()}),a&&a.scroll&&b("html,body").scrollToVisible(c)},b.fn.hasScrollbar=function(){return this.length&&this[0].clientHeight<this[0].scrollHeight},b.fn.log=function(a){return console.log("%s: %o",a,this),this},b.fn.chevronCrumbs=function(a){return this.each(function(){b(this).show().addClass("chevron-crumbs").children().not("#hide-scratch").addClass("chevron-crumb").append('<span class="chevron-outer"><span class="chevron-inner"></span></span>').filter(".active").prev().addClass("before-active")})},b.fn.fillWindowWithMe=function(a){function j(){i.height(0);var a=h.height()-(e.offset().top+e.height())+(f.height()-g.height()),j=Math.max(400,a);i.height(j),b.isFunction(c.onResize)&&c.onResize.call(d,j)}var c=b.extend({minHeight:400},a),d=b(this),e=b("#wrapper-container"),f=b("#main"),g=b("#not_right_side"),h=b(window),i=b(this).add(c.alsoResize);return j(),h.unbind("resize.fillWindowWithMe").bind("resize.fillWindowWithMe",j),this},b.fn.autoGrowInput=function(a){return a=b.extend({maxWidth:1e3,minWidth:0,comfortZone:70},a),this.filter("input:text").each(function(){var c=a.minWidth||b(this).width(),d="",e=b(this),f=b("<tester/>").css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:e.css("fontSize"),fontFamily:e.css("fontFamily"),fontWeight:e.css("fontWeight"),letterSpacing:e.css("letterSpacing"),whiteSpace:"nowrap"}),g=function(){setTimeout(function(){if(d===(d=e.val()))return;var b=d.replace(/&/g,"&amp;").replace(/\s/g,"&nbsp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");f.html(b);var g=f.width(),h=g+a.comfortZone<c?c:g+a.comfortZone,i=e.width(),j=h<i&&h>=c||h>c&&h<a.maxWidth;j&&e.width(h)})};f.insertAfter(e),b(this).bind("keyup keydown blur update change",g)}),this},b.fn.fixDialogButtons=function(){return this.each(function(){var a=b(this);a.find(".button-container:last .button, button[type=submit]").ifExists(function(c){a.find(".button-container:last, button[type=submit]").hide();var d=c.map(function(){var a=b(this);return{text:a.text(),"data-text-while-loading":a.data("textWhileLoading"),click:function(){a.click()}}}).get();d.length&&a.dialog("option","buttons",d)})})},b})