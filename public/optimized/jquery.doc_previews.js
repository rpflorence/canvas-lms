require(["INST","i18n","jquery","vendor/scribd.view","jquery.ajaxJSON","jquery.google-analytics","jquery.instructure_misc_helpers","jquery.loadingImg"],function(a,b,c,d){b=b.scoped("instructure");var e={"application/vnd.openxmlformats-officedocument.wordprocessingml.template":[1,1],"application/vnd.oasis.opendocument.spreadsheet":[1,1],"application/vnd.sun.xml.writer":[1,1],"application/excel":[1,1],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[1,1],"text/rtf":[1,!1],"application/vnd.openxmlformats-officedocument.spreadsheetml.template":[1,1],"application/vnd.sun.xml.impress":[1,1],"application/vnd.sun.xml.calc":[1,1],"application/vnd.ms-excel":[1,1],"application/msword":[1,1],"application/mspowerpoint":[1,1],"application/rtf":[1,1],"application/vnd.oasis.opendocument.presentation":[1,1],"application/vnd.oasis.opendocument.text":[1,1],"application/vnd.openxmlformats-officedocument.presentationml.template":[1,1],"application/vnd.openxmlformats-officedocument.presentationml.slideshow":[1,1],"text/plain":[1,!1],"application/vnd.openxmlformats-officedocument.presentationml.presentation":[1,1],"application/vnd.openxmlformats-officedocument.wordprocessingml.document":[1,1],"application/postscript":[1,1],"application/pdf":[1,1],"application/vnd.ms-powerpoint":[1,1]};c.filePreviewsEnabled=function(){return!a.disableScribdPreviews||!a.disableGooglePreviews},c.isPreviewable=function(b,d){return c.filePreviewsEnabled()&&e[b]&&(!d||!a["disable"+c.capitalize(d)+"Previews"]&&e[b][{scribd:0,google:1}[d]])},c.fn.loadDocPreview=function(e){var f=swfobject.getFlashPlayerVersion(),g=f&&f.major>9;return this.each(function(){function i(a){h.attachment_view_inline_ping_url&&(c.ajaxJSON(h.attachment_view_inline_ping_url,"POST",{},function(){},function(){}),c.trackEvent("Doc Previews",a,JSON.stringify(h)))}var f=c(this),h=c.extend({height:"400px"},f.data(),e);if(!a.disableScribdPreviews&&h.scribd_doc_id&&h.scribd_access_key&&g&&d){var j=d.Document.getDoc(h.scribd_doc_id,h.scribd_access_key),k=f.attr("id"),l=c.extend({jsapi_version:1,disable_related_docs:!0,auto_size:!1,height:h.height,use_ssl:"https:"==document.location.protocol},h.scribdParams);k||(k=c.uniqueId("scribd_preview_"),f.attr("id",k)),c.each(l,function(a,b){j.addParam(a,b)}),c.isFunction(h.ready)&&j.addEventListener("iPaperReady",h.ready),j.write(k),this.childNodes[0].keyboardShortcutDown=this.childNodes[0].keyboardShortcutUp=function(){},i("scribd")}else if(!a.disableGooglePreviews&&(!h.mimeType||c.isPreviewable(h.mimeType,"google"))&&h.attachment_id||h.public_url){function m(){var a="//docs.google.com/viewer?"+c.param({embedded:!0,url:h.public_url});c('<iframe src="'+a+'" height="'+h.height+'" width="100%" />').appendTo(f).load(function(){i("google"),c.isFunction(h.ready)&&h.ready()})}if(h.public_url)m();else if(h.attachment_id){var n="/files/"+h.attachment_id+"/public_url.json";h.submission_id&&(n+="?"+c.param({submission_id:h.submission_id})),f.loadingImage(),c.ajaxJSON(n,"GET",{},function(a){f.loadingImage("remove"),a&&a.public_url&&(c.extend(h,a),m())})}}else f.html("<p>"+htmlEscape(b.t("errors.cannot_view_document_inline","This document cannot be viewed inline, you might not have permission to view it or it might have been deleted."))+"</p>")})}})